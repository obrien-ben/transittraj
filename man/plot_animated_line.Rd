% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/trajectory_visualization.R
\name{plot_animated_line}
\alias{plot_animated_line}
\title{Generate an animated plot of a vehicle along a straight line.}
\usage{
plot_animated_line(
  trajectory = NULL,
  distance_df = NULL,
  plot_trips = NULL,
  timestep = 5,
  distance_lim = NULL,
  center_vehicles = FALSE,
  feature_distances = NULL,
  transition_style = "linear",
  route_color = "coral",
  route_width = 3,
  route_alpha = 1,
  feature_shape = 21,
  feature_outline = "black",
  feature_fill = "white",
  feature_size = 2,
  feature_stroke = 1.25,
  feature_alpha = 1,
  veh_shape = 23,
  veh_outline = "grey30",
  veh_fill = "white",
  veh_size = 3,
  veh_stroke = 2,
  veh_alpha = 0.8,
  label_field = NULL,
  label_size = 3,
  label_alpha = 0.6,
  label_pos = "left"
)
}
\arguments{
\item{trajectory}{Optional. A trajectory object, either a single trajectory
or grouped trajectory. If provided, \code{distance_df} must not be provided.
Default is \code{NULL}.}

\item{distance_df}{Optional. A dataframe of time and distance points. Must
include at least \code{event_timestamp} and numeric \code{distance}. If provided,
\code{trajectory} must not be provided. Default is \code{NULL}.}

\item{plot_trips}{Optional. A vector of \code{trip_id_performed}s to plot. Default
is \code{NULL}, which will plot all trips provided in the \code{trajectory} or
\code{distance_df}.}

\item{timestep}{Optional. If \code{trajectory} is provided, the time interval, in
seconds, between interpolated observations to plot. Default is 5.}

\item{distance_lim}{Optional. A vector with \verb{(minimum, maximum)} distance
values to plot.}

\item{center_vehicles}{Optional. A boolean, should all vehicle points be
centered to start at the same time (0 seconds)? Default is \code{FALSE}.}

\item{feature_distances}{Optional. A dataframe with at least numeric
\code{distance} for features. Default is \code{NULL}.}

\item{transition_style}{Optional. A \code{gganimate} \code{transition_style},
specifying how the animation transitions from point to point. See
\code{gganimate::ease_aes()}. Default is \code{"linear"}.}

\item{route_color}{Optional. A color string for the color of the background
route. Default is \code{"coral"}.}

\item{route_width}{Optional. A numeric, the linewidth of the background
route. Default is 3.}

\item{route_alpha}{Optional. A numeric, the opacity of the background route.
Default is 1.}

\item{feature_shape}{Optional. A numeric specifying the \code{ggplot2} point
shape, or a dataframe mapping an attribute in feature_distances to a shape.
Must contain column \code{shape}. Default is 21 (circle).}

\item{feature_outline}{Optional. A color string, or a dataframe mapping an
attribute in \code{feature_distances} to a color. Must contain column \code{outline}.
Default is \code{"black"}.}

\item{feature_fill}{Optional. A color string, the inside fill of feature
points. Default is \code{"white"}.}

\item{feature_size}{Optional. A numeric, the size of the feature point.
Default is 2.}

\item{feature_stroke}{Optional. A numeric, the linewidth of the feature point
outline. Default is 1.25.}

\item{feature_alpha}{Optional. A numeric, the opacity of the feature point.
Default is 1.}

\item{veh_shape}{Optional. A numeric specifying the \code{ggplot2} point shape, or
a dataframe mapping an attribute in \code{distance_df} or \code{trajectory} to
a shape. Must contain column \code{shape}. Default is 23 (diamond).}

\item{veh_outline}{Optional. A color string, or a dataframe mapping an
attribute in \code{distance_df} or \code{trajectory} to a color. Must contain column
\code{outline}. Default is \code{"grey30"}.}

\item{veh_fill}{Optional. A color string, the inside fill of the vehicle
point. Default is \code{"white"}.}

\item{veh_size}{Optional. A numeric, the size of the vehicle point. Default
is 3.}

\item{veh_stroke}{Optional. A numeric, the linewidth of the vehicle point
outline. Default is 2.}

\item{veh_alpha}{Optional. A numeric, the opacity of the feature point.
Default is 0.8.}

\item{label_field}{Optional. A string specifying the column in
\code{feature_distances} with which to label the feature lines. Default is \code{NULL},
where no labels will be plotted.}

\item{label_size}{Optional. The font size of the feature labels. Default is
3.}

\item{label_alpha}{Optional. The opacity of the feature labels. Default is
0.6.}

\item{label_pos}{Optional. A string specifying the label position on the
graph. Must be either \code{"left"} or \code{"right"}. Default is \code{"left"}.}
}
\value{
A gganimate object.
}
\description{
This function simplifies trajectories to a single straight line. Animations
are used to show vehicles' progressing along this line. Optionally, spatial
"features" and labels can be added as points along the route line. A
gganimate object is returned, which can be further modified and customized as
desired.
}
\details{
\subsection{Input Trajectory Data}{

There are two ways to provide data to these plotting functions:
\itemize{
\item A single or grouped trajectory function. This will use the direct
trajectory function at a resolution controlled by \code{timestep}. This is
simplest, and looks best when zooming in useing \code{distance_lim}. The only
attribute that can be mapped to if using a trajectory is \code{trip_id_performed}.
\item A \code{distance_df} of TIDES AVL data. This will use the distance and time
point pairs for plotting, and draw linearly between them. This will look
similar to a plot using \code{trajectory} when zoomed out. It is most useful
if you want to map formatting to attributes other than \code{trip_id_performed},
such as a vehicle or operator ID number. If starting with a \code{trajectory},
but the additional controll over formatting is desired, consider using
\code{predict()} to find generate distance and time points to plot, then joining
the desired attributes to the \code{trip_id_performed} column.
}

Note that only one of \code{trajectory} and \code{distance_df} can be used. If both
(or neither) are provided, an error will be thrown.
}

\subsection{Features and Labels}{

Often it is useful to plot the features of a route, such as its
stops/stations or the traffic signals it passes through. Use
\code{feature_distances} to provide information about spatial features to plot.
Each row in \code{feature_distances} should include at least a \code{distance} column.
Each of these rows will be plotted as a point on the route line.

These features can also be labeled. Set \code{label_name} to a character string
corresponding to a field in \code{feature_distances} to generate labels with
this field as their text. The color of the label will automatically match
that of the feature they describe. Labels will be placed at the y-value
of the feature, and the horizontal alignment can be controlled with
\code{label_pos}.
}

\subsection{Formatting Options}{

Once a layer is created on a \code{ggplot2} object, it is difficult to change its
formatting. As such, this function attempts to provide as much flexibility
in formatting its layers as possible. The resulting plot includes three
layers:
\itemize{
\item Route line, controlled by \code{route_color}, \code{route_width}, and \code{route_alpha}.
\item Features, controlled by \code{feature_fill}, \code{feature_outline}, \code{feature_shape},
\code{feature_size}, \code{feature_alpha}, and \code{feature_stroke}.
\item Labels, controlled by \code{label_size}, \code{label_alpha}, and \code{label_pos}.
\item Vehicles, controlled by \code{veh_fill}, \code{veh_outline}, \code{veh_shape},
\code{veh_size}, \code{veh_alpha}, and \code{veh_stroke}.
}

All of these formats can be controlled by inputting a single string or
numeric. The following attributes can also be modified using a dataframe,
mapping them to attributes of the layer:
\itemize{
\item \code{veh_shape} and \code{feature_shape}: A dataframe with one column named \code{shape},
and another column sharing a name with a column in \code{distance_df} or
\code{feature_distances} (or, if using \code{trajectory}, a column named
\code{trip_id_performed}). The values in \code{shape} should be valid \code{ggplot2} point
shapes, and the values in the mapping column should match the values in
feature or trip column.
\item \code{veh_outline} and \code{feature_outline}: A dataframe with one column named
\code{color}, and another column sharing a name with a column in \code{distance_df} or
\code{feature_distances} (or, if using \code{trajectory}, a column named
\code{trip_id_performed}). The values in \code{color} should be valid color string,
and the values in the mapping column should match the values in
feature or trip column.
}

Note that if inputting \code{trajectory}, instead of \code{distance_df}, \code{veh_shape}
and \code{veh_outline} can only be mapped to \code{trip_id_performed}. If using
\code{distance_df}, they may be mapped to any column in \code{distance_df} (e.g.,
vehicle or operator IDs).

For examples and a more in-depth discussion, see (xyz).
}
}
